/*! Editor.md v1.5.0 | /Users/restran/Workspace/WebStorm/editor.md/lib/codemirror/addons.min.js | Open source online markdown editor. | MIT License | By: Pandao | https://github.com/pandao/editor.md | 2020-03-25 */
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){e.defineOption("showTrailingSpace",!1,(function(t,n,o){o==e.Init&&(o=!1),o&&!n?t.removeOverlay("trailingspace"):!o&&n&&t.addOverlay({token:function(e){for(var t=e.string.length,n=t;n&&/\s/.test(e.string.charAt(n-1));--n);return n>e.pos?(e.pos=n,null):(e.pos=t,"trailingspace")},name:"trailingspace"})}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){function t(e,t,n){var o;return(o=e.getWrapperElement().appendChild(document.createElement("div"))).className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?o.innerHTML=t:o.appendChild(t),o}function n(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",(function(o,r,i){i||(i={}),n(this,null);var a=t(this,o,i.bottom),l=!1,s=this;function f(e){if("string"==typeof e)u.value=e;else{if(l)return;l=!0,a.parentNode.removeChild(a),s.focus(),i.onClose&&i.onClose(a)}}var c,u=a.getElementsByTagName("input")[0];return u?(i.value&&(u.value=i.value,u.select()),i.onInput&&e.on(u,"input",(function(e){i.onInput(e,u.value,f)})),i.onKeyUp&&e.on(u,"keyup",(function(e){i.onKeyUp(e,u.value,f)})),e.on(u,"keydown",(function(t){i&&i.onKeyDown&&i.onKeyDown(t,u.value,f)||((27==t.keyCode||!1!==i.closeOnEnter&&13==t.keyCode)&&(u.blur(),e.e_stop(t),f()),13==t.keyCode&&r(u.value,t))})),!1!==i.closeOnBlur&&e.on(u,"blur",f),u.focus()):(c=a.getElementsByTagName("button")[0])&&(e.on(c,"click",(function(){f(),s.focus()})),!1!==i.closeOnBlur&&e.on(c,"blur",f),c.focus()),f})),e.defineExtension("openConfirm",(function(o,r,i){n(this,null);var a=t(this,o,i&&i.bottom),l=a.getElementsByTagName("button"),s=!1,f=this,c=1;function u(){s||(s=!0,a.parentNode.removeChild(a),f.focus())}l[0].focus();for(var d=0;d<l.length;++d){var h=l[d];!function(t){e.on(h,"click",(function(n){e.e_preventDefault(n),u(),t&&t(f)}))}(r[d]),e.on(h,"blur",(function(){--c,setTimeout((function(){c<=0&&u()}),200)})),e.on(h,"focus",(function(){++c}))}})),e.defineExtension("openNotification",(function(o,r){n(this,f);var i,a=t(this,o,r&&r.bottom),l=!1,s=r&&void 0!==r.duration?r.duration:5e3;function f(){l||(l=!0,clearTimeout(i),a.parentNode.removeChild(a))}return e.on(a,"click",(function(t){e.e_preventDefault(t),f()})),s&&(i=setTimeout(f,s)),f}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";var t=e.Pos;function n(e,n,r,i){if(this.atOccurrence=!1,this.doc=e,null==i&&"string"==typeof n&&(i=!1),r=r?e.clipPos(r):t(0,0),this.pos={from:r,to:r},"string"!=typeof n)n.global||(n=new RegExp(n.source,n.ignoreCase?"ig":"g")),this.matches=function(o,r){if(o){n.lastIndex=0;for(var i=e.getLine(r.line).slice(0,r.ch),a=0;;){n.lastIndex=a;var l=n.exec(i);if(!l)break;if(f=(s=l).index,(a=s.index+(s[0].length||1))==i.length)break}(c=s&&s[0].length||0)||(0==f&&0==i.length?s=void 0:f!=e.getLine(r.line).length&&c++)}else{n.lastIndex=r.ch;i=e.getLine(r.line);var s,f,c=(s=n.exec(i))&&s[0].length||0;(f=s&&s.index)+c==i.length||c||(c=1)}if(s&&c)return{from:t(r.line,f),to:t(r.line,f+c),match:s}};else{var a=n;i&&(n=n.toLowerCase());var l=i?function(e){return e.toLowerCase()}:function(e){return e},s=n.split("\n");if(1==s.length)n.length?this.matches=function(r,i){if(r){var s=e.getLine(i.line).slice(0,i.ch);if((c=(f=l(s)).lastIndexOf(n))>-1)return c=o(s,f,c),{from:t(i.line,c),to:t(i.line,c+a.length)}}else{var f,c;s=e.getLine(i.line).slice(i.ch);if((c=(f=l(s)).indexOf(n))>-1)return c=o(s,f,c)+i.ch,{from:t(i.line,c),to:t(i.line,c+a.length)}}}:this.matches=function(){};else{var f=a.split("\n");this.matches=function(n,o){var r=s.length-1;if(n){if(o.line-(s.length-1)<e.firstLine())return;if(l(e.getLine(o.line).slice(0,f[r].length))!=s[s.length-1])return;for(var i=t(o.line,f[r].length),a=o.line-1,c=r-1;c>=1;--c,--a)if(s[c]!=l(e.getLine(a)))return;var u=(d=e.getLine(a)).length-f[0].length;if(l(d.slice(u))!=s[0])return;return{from:t(a,u),to:i}}if(!(o.line+(s.length-1)>e.lastLine())){var d;u=(d=e.getLine(o.line)).length-f[0].length;if(l(d.slice(u))==s[0]){var h=t(o.line,u);for(a=o.line+1,c=1;c<r;++c,++a)if(s[c]!=l(e.getLine(a)))return;if(l(e.getLine(a).slice(0,f[r].length))==s[r])return{from:h,to:t(a,f[r].length)}}}}}}}function o(e,t,n){if(e.length==t.length)return n;for(var o=Math.min(n,e.length);;){var r=e.slice(0,o).toLowerCase().length;if(r<n)++o;else{if(!(r>n))return o;--o}}}n.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){var n=this,o=this.doc.clipPos(e?this.pos.from:this.pos.to);function r(e){var o=t(e,0);return n.pos={from:o,to:o},n.atOccurrence=!1,!1}for(;;){if(this.pos=this.matches(e,o))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!o.line)return r(0);o=t(o.line-1,this.doc.getLine(o.line-1).length)}else{var i=this.doc.lineCount();if(o.line==i-1)return r(i);o=t(o.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(n){if(this.atOccurrence){var o=e.splitLines(n);this.doc.replaceRange(o,this.pos.from,this.pos.to),this.pos.to=t(this.pos.from.line+o.length-1,o[o.length-1].length+(1==o.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",(function(e,t,o){return new n(this.doc,e,t,o)})),e.defineDocExtension("getSearchCursor",(function(e,t,o){return new n(this,e,t,o)})),e.defineExtension("selectMatches",(function(t,n){for(var o=[],r=this.getSearchCursor(t,this.getCursor("from"),n);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)o.push({anchor:r.from(),head:r.to()});o.length&&this.setSelections(o,0)}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}((function(e){"use strict";function t(){this.posFrom=this.posTo=this.query=null,this.overlay=null}function n(e){return e.state.search||(e.state.search=new t)}function o(e){return"string"==typeof e&&e==e.toLowerCase()}function r(e,t,n){return e.getSearchCursor(t,n,o(t))}function i(e,t,n,o,r){e.openDialog?e.openDialog(t,r,{value:o}):r(prompt(n,o))}function a(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(e){}return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function l(e,t){var r=n(e);if(r.query)return s(e,t);i(e,'Search: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',"Search for:",e.getSelection(),(function(n){e.operation((function(){n&&!r.query&&(r.query=a(n),e.removeOverlay(r.overlay,o(r.query)),r.overlay=function(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var n=e.exec(t.string);if(n&&n.index==t.pos)return t.pos+=n[0].length,"searching";n?t.pos=n.index:t.skipToEnd()}}}(r.query,o(r.query)),e.addOverlay(r.overlay),e.showMatchesOnScrollbar&&(r.annotate&&(r.annotate.clear(),r.annotate=null),r.annotate=e.showMatchesOnScrollbar(r.query,o(r.query))),r.posFrom=r.posTo=e.getCursor(),s(e,t))}))}))}function s(t,o){t.operation((function(){var i=n(t),a=r(t,i.query,o?i.posFrom:i.posTo);(a.find(o)||(a=r(t,i.query,o?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0))).find(o))&&(t.setSelection(a.from(),a.to()),t.scrollIntoView({from:a.from(),to:a.to()}),i.posFrom=a.from(),i.posTo=a.to())}))}function f(e){e.operation((function(){var t=n(e);t.query&&(t.query=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))}))}function c(e,t){e.getOption("readOnly")||i(e,'Replace: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',"Replace:",e.getSelection(),(function(n){n&&(n=a(n),i(e,'With: <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',"Replace with:","",(function(o){if(t)e.operation((function(){for(var t=r(e,n);t.findNext();)if("string"!=typeof n){var i=e.getRange(t.from(),t.to()).match(n);t.replace(o.replace(/\$(\d)/g,(function(e,t){return i[t]})))}else t.replace(o)}));else{f(e);var i=r(e,n,e.getCursor()),a=function(){var t,o=i.from();!(t=i.findNext())&&(i=r(e,n),!(t=i.findNext())||o&&i.from().line==o.line&&i.from().ch==o.ch)||(e.setSelection(i.from(),i.to()),e.scrollIntoView({from:i.from(),to:i.to()}),function(e,t,n,o){e.openConfirm?e.openConfirm(t,o):confirm(n)&&o[0]()}(e,"Replace? <button>Yes</button> <button>No</button> <button>Stop</button>","Replace?",[function(){l(t)},a]))},l=function(e){i.replace("string"==typeof n?o:o.replace(/\$(\d)/g,(function(t,n){return e[n]}))),a()};a()}})))}))}e.commands.find=function(e){f(e),l(e)},e.commands.findNext=l,e.commands.findPrev=function(e){l(e,!0)},e.commands.clearSearch=f,e.commands.replace=c,e.commands.replaceAll=function(e){c(e,!0)}})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";function t(e,t){function n(e){clearTimeout(o.doRedraw),o.doRedraw=setTimeout((function(){o.redraw()}),e)}this.cm=e,this.options=t,this.buttonHeight=t.scrollButtonHeight||e.getOption("scrollButtonHeight"),this.annotations=[],this.doRedraw=this.doUpdate=null,this.div=e.getWrapperElement().appendChild(document.createElement("div")),this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none",this.computeScale();var o=this;e.on("refresh",this.resizeHandler=function(){clearTimeout(o.doUpdate),o.doUpdate=setTimeout((function(){o.computeScale()&&n(20)}),100)}),e.on("markerAdded",this.resizeHandler),e.on("markerCleared",this.resizeHandler),!1!==t.listenForChanges&&e.on("change",this.changeHandler=function(){n(250)})}e.defineExtension("annotateScrollbar",(function(e){return"string"==typeof e&&(e={className:e}),new t(this,e)})),e.defineOption("scrollButtonHeight",0),t.prototype.computeScale=function(){var e=this.cm,t=(e.getWrapperElement().clientHeight-e.display.barHeight-2*this.buttonHeight)/e.heightAtLine(e.lastLine()+1,"local");if(t!=this.hScale)return this.hScale=t,!0},t.prototype.update=function(e){this.annotations=e,this.redraw()},t.prototype.redraw=function(e){!1!==e&&this.computeScale();var t=this.cm,n=this.hScale,o=document.createDocumentFragment(),r=this.annotations;if(t.display.barWidth)for(var i,a=0;a<r.length;a++){for(var l=r[a],s=i||t.charCoords(l.from,"local").top*n,f=t.charCoords(l.to,"local").bottom*n;a<r.length-1&&!((i=t.charCoords(r[a+1].from,"local").top*n)>f+.9);)l=r[++a],f=t.charCoords(l.to,"local").bottom*n;if(f!=s){var c=Math.max(f-s,3),u=o.appendChild(document.createElement("div"));u.style.cssText="position: absolute; right: 0px; width: "+Math.max(t.display.barWidth-1,2)+"px; top: "+(s+this.buttonHeight)+"px; height: "+c+"px",u.className=this.options.className}}this.div.textContent="",this.div.appendChild(o)},t.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler),this.cm.off("markerAdded",this.resizeHandler),this.cm.off("markerCleared",this.resizeHandler),this.changeHandler&&this.cm.off("change",this.changeHandler),this.div.parentNode.removeChild(this.div)}})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],e):e(CodeMirror)}((function(e){"use strict";function t(e,t,n,o){this.cm=e;var r={listenForChanges:!1};for(var i in o)r[i]=o[i];r.className||(r.className="CodeMirror-search-match"),this.annotation=e.annotateScrollbar(r),this.query=t,this.caseFold=n,this.gap={from:e.firstLine(),to:e.lastLine()+1},this.matches=[],this.update=null,this.findMatches(),this.annotation.update(this.matches);var a=this;e.on("change",this.changeHandler=function(e,t){a.onChange(t)})}e.defineExtension("showMatchesOnScrollbar",(function(e,n,o){return"string"==typeof o&&(o={className:o}),o||(o={}),new t(this,e,n,o)}));function n(e,t,n){return e<=t?e:Math.max(t,e+n)}t.prototype.findMatches=function(){if(this.gap){for(var t=0;t<this.matches.length;t++){if((o=this.matches[t]).from.line>=this.gap.to)break;o.to.line>=this.gap.from&&this.matches.splice(t--,1)}for(var n=this.cm.getSearchCursor(this.query,e.Pos(this.gap.from,0),this.caseFold);n.findNext();){var o;if((o={from:n.from(),to:n.to()}).from.line>=this.gap.to)break;if(this.matches.splice(t++,0,o),this.matches.length>1e3)break}this.gap=null}},t.prototype.onChange=function(t){var o=t.from.line,r=e.changeEnd(t).line,i=r-t.to.line;if(this.gap?(this.gap.from=Math.min(n(this.gap.from,o,i),t.from.line),this.gap.to=Math.max(n(this.gap.to,o,i),t.from.line)):this.gap={from:t.from.line,to:r+1},i)for(var a=0;a<this.matches.length;a++){var l=this.matches[a],s=n(l.from.line,o,i);s!=l.from.line&&(l.from=e.Pos(s,l.from.ch));var f=n(l.to.line,o,i);f!=l.to.line&&(l.to=e.Pos(f,l.to.ch))}clearTimeout(this.update);var c=this;this.update=setTimeout((function(){c.updateAfterChange()}),250)},t.prototype.updateAfterChange=function(){this.findMatches(),this.annotation.update(this.matches)},t.prototype.clear=function(){this.cm.off("change",this.changeHandler),this.annotation.clear()}})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function n(e){t(e);var n=e.state.placeholder=document.createElement("pre");n.style.cssText="height: 0; overflow: visible",n.className="CodeMirror-placeholder",n.appendChild(document.createTextNode(e.getOption("placeholder"))),e.display.lineSpace.insertBefore(n,e.display.lineSpace.firstChild)}function o(e){i(e)&&n(e)}function r(e){var o=e.getWrapperElement(),r=i(e);o.className=o.className.replace(" CodeMirror-empty","")+(r?" CodeMirror-empty":""),r?n(e):t(e)}function i(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",(function(n,i,a){var l=a&&a!=e.Init;if(i&&!l)n.on("blur",o),n.on("change",r),r(n);else if(!i&&l){n.off("blur",o),n.off("change",r),t(n);var s=n.getWrapperElement();s.className=s.className.replace(" CodeMirror-empty","")}i&&!n.hasFocus()&&o(n)}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}((function(e){e.defineOption("autoCloseTags",!1,(function(a,l,s){if(s!=e.Init&&s&&a.removeKeyMap("autoCloseTags"),l){var f={name:"autoCloseTags"};("object"!=typeof l||l.whenClosing)&&(f["'/'"]=function(t){return function(t){return t.getOption("disableInput")?e.Pass:o(t,!0)}(t)}),("object"!=typeof l||l.whenOpening)&&(f["'>'"]=function(o){return function(o){if(o.getOption("disableInput"))return e.Pass;for(var a=o.listSelections(),l=[],s=0;s<a.length;s++){if(!a[s].empty())return e.Pass;var f=a[s].head,c=o.getTokenAt(f),u=e.innerMode(o.getMode(),c.state),d=u.state;if("xml"!=u.mode.name||!d.tagName)return e.Pass;var h=o.getOption("autoCloseTags"),p="html"==u.mode.configuration,m="object"==typeof h&&h.dontCloseTags||p&&t,g="object"==typeof h&&h.indentTags||p&&n,v=d.tagName;c.end>f.ch&&(v=v.slice(0,v.length-c.end+f.ch));var y=v.toLowerCase();if(!v||"string"==c.type&&(c.end!=f.ch||!/[\"\']/.test(c.string.charAt(c.string.length-1))||1==c.string.length)||"tag"==c.type&&"closeTag"==d.type||c.string.indexOf("/")==c.string.length-1||m&&r(m,y)>-1||i(o,v,f,d,!0))return e.Pass;var b=g&&r(g,y)>-1;l[s]={indent:b,text:">"+(b?"\n\n":"")+"</"+v+">",newPos:b?e.Pos(f.line+1,0):e.Pos(f.line,f.ch+1)}}for(s=a.length-1;s>=0;s--){var C=l[s];o.replaceRange(C.text,a[s].head,a[s].anchor,"+insert");var x=o.listSelections().slice(0);x[s]={head:C.newPos,anchor:C.newPos},o.setSelections(x),C.indent&&(o.indentLine(C.newPos.line,null,!0),o.indentLine(C.newPos.line+1,null,!0))}}(o)}),a.addKeyMap(f)}}));var t=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],n=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];function o(t,n){for(var o=t.listSelections(),r=[],a=n?"/":"</",l=0;l<o.length;l++){if(!o[l].empty())return e.Pass;var s=o[l].head,f=t.getTokenAt(s),c=e.innerMode(t.getMode(),f.state),u=c.state;if(n&&("string"==f.type||"<"!=f.string.charAt(0)||f.start!=s.ch-1))return e.Pass;if("xml"!=c.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==c.mode.name)r[l]=a+"script>";else{if("htmlmixed"!=t.getMode().name||"css"!=c.mode.name)return e.Pass;r[l]=a+"style>"}else{if(!u.context||!u.context.tagName||i(t,u.context.tagName,s,u))return e.Pass;r[l]=a+u.context.tagName+">"}}t.replaceSelections(r),o=t.listSelections();for(l=0;l<o.length;l++)(l==o.length-1||o[l].head.line<o[l+1].head.line)&&t.indentLine(o[l].head.line)}function r(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;++n)if(e[n]==t)return n;return-1}function i(t,n,o,r,i){if(!e.scanForClosingTag)return!1;var a=Math.min(t.lastLine()+1,o.line+500),l=e.scanForClosingTag(t,o,null,a);if(!l||l.tag!=n)return!1;for(var s=r.context,f=i?1:0;s&&s.tagName==n;s=s.prev)++f;o=l.to;for(var c=1;c<f;c++){var u=e.scanForClosingTag(t,o,null,a);if(!u||u.tag!=n)return!1;o=u.to}return!0}e.commands.closeTag=function(e){return o(e)}})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";function t(t,n,r,i){if(r&&r.call){var a=r;r=null}else a=o(t,r,"rangeFinder");"number"==typeof n&&(n=e.Pos(n,0));var l=o(t,r,"minFoldSize");function s(e){var o=a(t,n);if(!o||o.to.line-o.from.line<l)return null;for(var r=t.findMarksAt(o.from),s=0;s<r.length;++s)if(r[s].__isFold&&"fold"!==i){if(!e)return null;o.cleared=!0,r[s].clear()}return o}var f=s(!0);if(o(t,r,"scanUp"))for(;!f&&n.line>t.firstLine();)n=e.Pos(n.line-1,0),f=s(!1);if(f&&!f.cleared&&"unfold"!==i){var c=function(e,t){var n=o(e,t,"widget");if("string"==typeof n){var r=document.createTextNode(n);(n=document.createElement("span")).appendChild(r),n.className="CodeMirror-foldmarker"}return n}(t,r);e.on(c,"mousedown",(function(t){u.clear(),e.e_preventDefault(t)}));var u=t.markText(f.from,f.to,{replacedWith:c,clearOnEnter:!0,__isFold:!0});u.on("clear",(function(n,o){e.signal(t,"unfold",t,n,o)})),e.signal(t,"fold",t,f.from,f.to)}}e.newFoldFunction=function(e,n){return function(o,r){t(o,r,{rangeFinder:e,widget:n})}},e.defineExtension("foldCode",(function(e,n,o){t(this,e,n,o)})),e.defineExtension("isFolded",(function(e){for(var t=this.findMarksAt(e),n=0;n<t.length;++n)if(t[n].__isFold)return!0})),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation((function(){for(var n=t.firstLine(),o=t.lastLine();n<=o;n++)t.foldCode(e.Pos(n,0),null,"fold")}))},e.commands.unfoldAll=function(t){t.operation((function(){for(var n=t.firstLine(),o=t.lastLine();n<=o;n++)t.foldCode(e.Pos(n,0),null,"unfold")}))},e.registerHelper("fold","combine",(function(){var e=Array.prototype.slice.call(arguments,0);return function(t,n){for(var o=0;o<e.length;++o){var r=e[o](t,n);if(r)return r}}})),e.registerHelper("fold","auto",(function(e,t){for(var n=e.getHelpers(t,"fold"),o=0;o<n.length;o++){var r=n[o](e,t);if(r)return r}}));var n={rangeFinder:e.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1};function o(e,t,o){if(t&&void 0!==t[o])return t[o];var r=e.options.foldOptions;return r&&void 0!==r[o]?r[o]:n[o]}e.defineOption("foldOptions",null),e.defineExtension("foldOption",(function(e,t){return o(this,e,t)}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}((function(e){"use strict";e.defineOption("foldGutter",!1,(function(t,o,r){r&&r!=e.Init&&(t.clearGutter(t.state.foldGutter.options.gutter),t.state.foldGutter=null,t.off("gutterClick",a),t.off("change",l),t.off("viewportChange",s),t.off("fold",f),t.off("unfold",f),t.off("swapDoc",i)),o&&(t.state.foldGutter=new n(function(e){!0===e&&(e={});null==e.gutter&&(e.gutter="CodeMirror-foldgutter");null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open");null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded");return e}(o)),i(t),t.on("gutterClick",a),t.on("change",l),t.on("viewportChange",s),t.on("fold",f),t.on("unfold",f),t.on("swapDoc",i))}));var t=e.Pos;function n(e){this.options=e,this.from=this.to=0}function o(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function r(e,n,r){var i=e.state.foldGutter.options,a=n,l=e.foldOption(i,"minFoldSize"),s=e.foldOption(i,"rangeFinder");e.eachLine(n,r,(function(n){var r=null;if(function(e,n){for(var o=e.findMarksAt(t(n)),r=0;r<o.length;++r)if(o[r].__isFold&&o[r].find().from.line==n)return!0}(e,a))r=o(i.indicatorFolded);else{var f=t(a,0),c=s&&s(e,f);c&&c.to.line-c.from.line>=l&&(r=o(i.indicatorOpen))}e.setGutterMarker(n,i.gutter,r),++a}))}function i(e){var t=e.getViewport(),n=e.state.foldGutter;n&&(e.operation((function(){r(e,t.from,t.to)})),n.from=t.from,n.to=t.to)}function a(e,n,o){var r=e.state.foldGutter;if(r){var i=r.options;o==i.gutter&&e.foldCode(t(n,0),i.rangeFinder)}}function l(e){var t=e.state.foldGutter;if(t){var n=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){i(e)}),n.foldOnChangeTimeSpan||600)}}function s(e){var t=e.state.foldGutter;if(t){var n=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){var n=e.getViewport();t.from==t.to||n.from-t.to>20||t.from-n.to>20?i(e):e.operation((function(){n.from<t.from&&(r(e,n.from,t.from),t.from=n.from),n.to>t.to&&(r(e,t.to,n.to),t.to=n.to)}))}),n.updateViewportTimeSpan||400)}}function f(e,t){var n=e.state.foldGutter;if(n){var o=t.line;o>=n.from&&o<n.to&&r(e,o,o+1)}}})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.registerHelper("fold","indent",(function(t,n){var o=t.getOption("tabSize"),r=t.getLine(n.line);if(/\S/.test(r)){for(var i=function(t){return e.countColumn(t,null,o)},a=i(r),l=null,s=n.line+1,f=t.lastLine();s<=f;++s){var c=t.getLine(s);if(i(c)>a)l=s;else if(/\S/.test(c))break}return l?{from:e.Pos(n.line,r.length),to:e.Pos(l,t.getLine(l).length)}:void 0}}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.registerHelper("fold","brace",(function(t,n){var o,r=n.line,i=t.getLine(r);function a(a){for(var l=n.ch,s=0;;){var f=l<=0?-1:i.lastIndexOf(a,l-1);if(-1!=f){if(1==s&&f<n.ch)break;if(o=t.getTokenTypeAt(e.Pos(r,f+1)),!/^(comment|string)/.test(o))return f+1;l=f-1}else{if(1==s)break;s=1,l=i.length}}}var l,s="{",f="}";if(null==(l=a("{"))&&(s="[",f="]",l=a("[")),null!=l){var c,u,d=1,h=t.lastLine();e:for(var p=r;p<=h;++p)for(var m=t.getLine(p),g=p==r?l:0;;){var v=m.indexOf(s,g),y=m.indexOf(f,g);if(v<0&&(v=m.length),y<0&&(y=m.length),(g=Math.min(v,y))==m.length)break;if(t.getTokenTypeAt(e.Pos(p,g+1))==o)if(g==v)++d;else if(!--d){c=p,u=g;break e}++g}if(null!=c&&(r!=c||u!=l))return{from:e.Pos(r,l),to:e.Pos(c,u)}}})),e.registerHelper("fold","import",(function(t,n){function o(n){if(n<t.firstLine()||n>t.lastLine())return null;var o=t.getTokenAt(e.Pos(n,1));if(/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"keyword"!=o.type||"import"!=o.string)return null;for(var r=n,i=Math.min(t.lastLine(),n+10);r<=i;++r){var a=t.getLine(r).indexOf(";");if(-1!=a)return{startCh:o.end,end:e.Pos(r,a)}}}var r,i=o(n=n.line);if(!i||o(n-1)||(r=o(n-2))&&r.end.line==n-1)return null;for(var a=i.end;;){var l=o(a.line+1);if(null==l)break;a=l.end}return{from:t.clipPos(e.Pos(n,i.startCh+1)),to:a}})),e.registerHelper("fold","include",(function(t,n){function o(n){if(n<t.firstLine()||n>t.lastLine())return null;var o=t.getTokenAt(e.Pos(n,1));return/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"meta"==o.type&&"#include"==o.string.slice(0,8)?o.start+8:void 0}var r=o(n=n.line);if(null==r||null!=o(n-1))return null;for(var i=n;;){if(null==o(i+1))break;++i}return{from:e.Pos(n,r+1),to:t.clipPos(e.Pos(i))}}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";var t=e.Pos;var n="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",o=new RegExp("<(/?)(["+n+"][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");function r(e,t,n,o){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=o?o.from:e.firstLine(),this.max=o?o.to-1:e.lastLine()}function i(e,n){var o=e.cm.getTokenTypeAt(t(e.line,n));return o&&/\btag\b/.test(o)}function a(e){if(!(e.line>=e.max))return e.ch=0,e.text=e.cm.getLine(++e.line),!0}function l(e){if(!(e.line<=e.min))return e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0}function s(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(a(e))continue;return}if(i(e,t+1)){var n=e.text.lastIndexOf("/",t),o=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,o?"selfClose":"regular"}e.ch=t+1}}function f(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(l(e))continue;return}if(i(e,t+1)){o.lastIndex=t,e.ch=t;var n=o.exec(e.text);if(n&&n.index==t)return n}else e.ch=t}}function c(e){for(;;){o.lastIndex=e.ch;var t=o.exec(e.text);if(!t){if(a(e))continue;return}if(i(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}function u(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(l(e))continue;return}if(i(e,t+1)){var n=e.text.lastIndexOf("/",t),o=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,o?"selfClose":"regular"}e.ch=t}}function d(e,n){for(var o=[];;){var r,i=c(e),a=e.line,l=e.ch-(i?i[0].length:0);if(!i||!(r=s(e)))return;if("selfClose"!=r)if(i[1]){for(var f=o.length-1;f>=0;--f)if(o[f]==i[2]){o.length=f;break}if(f<0&&(!n||n==i[2]))return{tag:i[2],from:t(a,l),to:t(e.line,e.ch)}}else o.push(i[2])}}function h(e,n){for(var o=[];;){var r=u(e);if(!r)return;if("selfClose"!=r){var i=e.line,a=e.ch,l=f(e);if(!l)return;if(l[1])o.push(l[2]);else{for(var s=o.length-1;s>=0;--s)if(o[s]==l[2]){o.length=s;break}if(s<0&&(!n||n==l[2]))return{tag:l[2],from:t(e.line,e.ch),to:t(i,a)}}}else f(e)}}e.registerHelper("fold","xml",(function(e,n){for(var o=new r(e,n.line,0);;){var i,a=c(o);if(!a||o.line!=n.line||!(i=s(o)))return;if(!a[1]&&"selfClose"!=i){n=t(o.line,o.ch);var l=d(o,a[2]);return l&&{from:n,to:l.from}}}})),e.findMatchingTag=function(e,n,o){var i=new r(e,n.line,n.ch,o);if(-1!=i.text.indexOf(">")||-1!=i.text.indexOf("<")){var a=s(i),l=a&&t(i.line,i.ch),c=a&&f(i);if(a&&c&&(p=n,!(((u=i).line-p.line||u.ch-p.ch)>0))){var u,p,m={from:t(i.line,i.ch),to:l,tag:c[2]};return"selfClose"==a?{open:m,close:null,at:"open"}:c[1]?{open:h(i,c[2]),close:m,at:"close"}:{open:m,close:d(i=new r(e,l.line,l.ch,o),c[2]),at:"open"}}}},e.findEnclosingTag=function(e,t,n){for(var o=new r(e,t.line,t.ch,n);;){var i=h(o);if(!i)break;var a=d(new r(e,t.line,t.ch,n),i.tag);if(a)return{open:i,close:a}}},e.scanForClosingTag=function(e,t,n,o){return d(new r(e,t.line,t.ch,o?{from:0,to:o}:null),n)}})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.registerHelper("fold","markdown",(function(t,n){function o(n){var o=t.getTokenTypeAt(e.Pos(n,0));return o&&/\bheader\b/.test(o)}function r(e,t,n){var r=t&&t.match(/^#+/);return r&&o(e)?r[0].length:(r=n&&n.match(/^[=\-]+\s*$/))&&o(e+1)?"="==n[0]?1:2:100}var i=t.getLine(n.line),a=t.getLine(n.line+1),l=r(n.line,i,a);if(100!==l){for(var s=t.lastLine(),f=n.line,c=t.getLine(f+2);f<s&&!(r(f+1,a,c)<=l);)++f,a=c,c=t.getLine(f+2);return{from:e.Pos(n.line,i.length),to:e.Pos(f,t.getLine(f).length)}}}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.registerGlobalHelper("fold","comment",(function(e){return e.blockCommentStart&&e.blockCommentEnd}),(function(t,n){var o=t.getModeAt(n),r=o.blockCommentStart,i=o.blockCommentEnd;if(r&&i){for(var a,l=n.line,s=t.getLine(l),f=n.ch,c=0;;){var u=f<=0?-1:s.lastIndexOf(r,f-1);if(-1!=u){if(1==c&&u<n.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(l,u+1)))){a=u+r.length;break}f=u-1}else{if(1==c)return;c=1,f=s.length}}var d,h,p=1,m=t.lastLine();e:for(var g=l;g<=m;++g)for(var v=t.getLine(g),y=g==l?a:0;;){var b=v.indexOf(r,y),C=v.indexOf(i,y);if(b<0&&(b=v.length),C<0&&(C=v.length),(y=Math.min(b,C))==v.length)break;if(y==b)++p;else if(!--p){d=g,h=y;break e}++y}if(null!=d&&(l!=d||h!=a))return{from:e.Pos(l,a),to:e.Pos(d,h)}}}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.overlayMode=function(t,n,o){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(o){return{base:e.copyState(t,o.base),overlay:e.copyState(n,o.overlay),basePos:o.basePos,baseCur:null,overlayPos:o.overlayPos,overlayCur:null}},token:function(e,r){return(e!=r.streamSeen||Math.min(r.basePos,r.overlayPos)<e.start)&&(r.streamSeen=e,r.basePos=r.overlayPos=e.start),e.start==r.basePos&&(r.baseCur=t.token(e,r.base),r.basePos=e.pos),e.start==r.overlayPos&&(e.pos=e.start,r.overlayCur=n.token(e,r.overlay),r.overlayPos=e.pos),e.pos=Math.min(r.basePos,r.overlayPos),null==r.overlayCur?r.baseCur:null!=r.baseCur&&r.overlay.combineTokens||o&&null==r.overlay.combineTokens?r.baseCur+" "+r.overlayCur:r.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){t.blankLine&&t.blankLine(e.base),n.blankLine&&n.blankLine(e.overlay)}}}})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";var t="CodeMirror-activeline-background";function n(e){for(var n=0;n<e.state.activeLines.length;n++)e.removeLineClass(e.state.activeLines[n],"wrap","CodeMirror-activeline"),e.removeLineClass(e.state.activeLines[n],"background",t)}function o(e,o){for(var r=[],i=0;i<o.length;i++){var a=o[i];if(a.empty()){var l=e.getLineHandleVisualStart(a.head.line);r[r.length-1]!=l&&r.push(l)}}(function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0})(e.state.activeLines,r)||e.operation((function(){n(e);for(var o=0;o<r.length;o++)e.addLineClass(r[o],"wrap","CodeMirror-activeline"),e.addLineClass(r[o],"background",t);e.state.activeLines=r}))}function r(e,t){o(e,t.ranges)}e.defineOption("styleActiveLine",!1,(function(t,i,a){var l=a&&a!=e.Init;i&&!l?(t.state.activeLines=[],o(t,t.listSelections()),t.on("beforeSelectionChange",r)):!i&&l&&(t.off("beforeSelectionChange",r),n(t),delete t.state.activeLines)}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){var t=/\s/,n=e.Pos;function o(e,t){var o=e.getRange(n(t.line,t.ch-1),n(t.line,t.ch+1));return 2==o.length?o:null}function r(t,n,o){var r=t.getLine(n.line),i=t.getTokenAt(n);if(/\bstring2?\b/.test(i.type))return!1;var a=new e.StringStream(r.slice(0,n.ch)+o+r.slice(n.ch),4);for(a.pos=a.start=i.start;;){var l=t.getMode().token(a,i.state);if(a.pos>=n.ch+1)return/\bstring2?\b/.test(l);a.start=a.pos}}e.defineOption("autoCloseBrackets",!1,(function(i,a,l){if(l!=e.Init&&l&&i.removeKeyMap("autoCloseBrackets"),a){var s="()[]{}''\"\"",f="'\"",c="[]{}";"string"==typeof a?s=a:"object"==typeof a&&(null!=a.pairs&&(s=a.pairs),null!=a.triples&&(f=a.triples),null!=a.explode&&(c=a.explode));var u=function(i,a){for(var l={name:"autoCloseBrackets",Backspace:function(t){if(t.getOption("disableInput"))return e.Pass;for(var r=t.listSelections(),a=0;a<r.length;a++){if(!r[a].empty())return e.Pass;var l=o(t,r[a].head);if(!l||i.indexOf(l)%2!=0)return e.Pass}for(a=r.length-1;a>=0;a--){var s=r[a].head;t.replaceRange("",n(s.line,s.ch-1),n(s.line,s.ch+1))}}},s="",f=0;f<i.length;f+=2)!function(o,i){s+=i,l["'"+o+"'"]=function(l){if(l.getOption("disableInput"))return e.Pass;for(var f,c=l.listSelections(),u=0;u<c.length;u++){var d,h=c[u],p=h.head,m=l.getRange(p,n(p.line,p.ch+1));if(h.empty())if(o==i&&m==i)d=l.getRange(p,n(p.line,p.ch+3))==o+o+o?"skipThree":"skip";else if(o==i&&p.ch>1&&a.indexOf(o)>=0&&l.getRange(n(p.line,p.ch-2),p)==o+o&&(p.ch<=2||l.getRange(n(p.line,p.ch-3),n(p.line,p.ch-2))!=o))d="addFour";else if('"'==o||"'"==o){if(e.isWordChar(m)||!r(l,p,o))return e.Pass;d="both"}else{if(!(l.getLine(p.line).length==p.ch||s.indexOf(m)>=0||t.test(m)))return e.Pass;d="both"}else d="surround";if(f){if(f!=d)return e.Pass}else f=d}l.operation((function(){if("skip"==f)l.execCommand("goCharRight");else if("skipThree"==f)for(var e=0;e<3;e++)l.execCommand("goCharRight");else if("surround"==f){var t=l.getSelections();for(e=0;e<t.length;e++)t[e]=o+t[e]+i;l.replaceSelections(t,"around")}else"both"==f?(l.replaceSelection(o+i,null),l.execCommand("goCharLeft")):"addFour"==f&&(l.replaceSelection(o+o+o+o,"before"),l.execCommand("goCharRight"))}))},o!=i&&(l["'"+i+"'"]=function(t){for(var o=t.listSelections(),r=0;r<o.length;r++){var a=o[r];if(!a.empty()||t.getRange(a.head,n(a.head.line,a.head.ch+1))!=i)return e.Pass}t.execCommand("goCharRight")})}(i.charAt(f),i.charAt(f+1));return l}(s,f);c&&(u.Enter=function(t){return function(n){if(n.getOption("disableInput"))return e.Pass;for(var r=n.listSelections(),i=0;i<r.length;i++){if(!r[i].empty())return e.Pass;var a=o(n,r[i].head);if(!a||t.indexOf(a)%2!=0)return e.Pass}n.operation((function(){n.replaceSelection("\n\n",null),n.execCommand("goCharLeft"),r=n.listSelections();for(var e=0;e<r.length;e++){var t=r[e].head.line;n.indentLine(t,null,!0),n.indentLine(t+1,null,!0)}}))}}(c)),i.addKeyMap(u)}}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.defineOption("fullScreen",!1,(function(t,n,o){o==e.Init&&(o=!1),!o!=!n&&(n?function(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}(t):function(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var n=e.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),e.refresh()}(t))}))})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";function t(e){"object"==typeof e&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay,this.wordsOnly=e.wordsOnly),null==this.style&&(this.style="matchhighlight"),null==this.minChars&&(this.minChars=2),null==this.delay&&(this.delay=100),null==this.wordsOnly&&(this.wordsOnly=!1),this.overlay=this.timeout=null}function n(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout),t.timeout=setTimeout((function(){o(e)}),t.delay)}function o(e){e.operation((function(){var t=e.state.matchHighlighter;if(t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null),e.somethingSelected()||!t.showToken){var n=e.getCursor("from"),o=e.getCursor("to");if(n.line==o.line&&(!t.wordsOnly||function(e,t,n){if(null!==e.getRange(t,n).match(/^\w+$/)){if(t.ch>0){var o={line:t.line,ch:t.ch-1};if(null===e.getRange(o,t).match(/\W/))return!1}if(n.ch<e.getLine(t.line).length){o={line:n.line,ch:n.ch+1};if(null===e.getRange(n,o).match(/\W/))return!1}return!0}return!1}(e,n,o))){var i=e.getRange(n,o).replace(/^\s+|\s+$/g,"");i.length>=t.minChars&&e.addOverlay(t.overlay=r(i,!1,t.style))}}else{for(var a=!0===t.showToken?/[\w$]/:t.showToken,l=e.getCursor(),s=e.getLine(l.line),f=l.ch,c=f;f&&a.test(s.charAt(f-1));)--f;for(;c<s.length&&a.test(s.charAt(c));)++c;f<c&&e.addOverlay(t.overlay=r(s.slice(f,c),a,t.style))}}))}function r(e,t,n){return{token:function(o){if(o.match(e)&&(!t||function(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}(o,t)))return n;o.next(),o.skipTo(e.charAt(0))||o.skipToEnd()}}}e.defineOption("highlightSelectionMatches",!1,(function(r,i,a){if(a&&a!=e.Init){var l=r.state.matchHighlighter.overlay;l&&r.removeOverlay(l),clearTimeout(r.state.matchHighlighter.timeout),r.state.matchHighlighter=null,r.off("cursorActivity",n)}i&&(r.state.matchHighlighter=new t(i),o(r),r.on("cursorActivity",n))}))}));